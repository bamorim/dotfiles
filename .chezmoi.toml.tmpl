{{define "gpg_key"}}
{{- $gpg_get_key := "gpg --list-secret-keys --keyid-format=long" -}}
{{- $gpg_extract_ssb := "grep '^ssb' | awk '{print $2}' | cut -d'/' -f2 | tr -d '\n'" -}}
{{ output "sh" "-c" (printf "%s %s | %s" $gpg_get_key . $gpg_extract_ssb) | quote -}}
{{end -}}

[diff]
  format = "git"
  pager = "delta"

[data.github]
  username = "bamorim"
  token = {{ (onepassword "ur647w55wx2o4pf3fx7d2z4ada").details.password | quote }}

[data.git]
  email = "contato@bamorim.com"
  signing_key = {{ template "gpg_key" "contato@bamorim.com" }}
  salt.email = "bernardo.amorim@saltpay.co"
  salt.signing_key = {{ template "gpg_key" "bernardo.amorim@saltpay.co" }}

[data.heroku]
  username = {{ (onepasswordDetailsFields "ug2d3ssijhy353ajrffwx2lwei").username.value | quote }}
  password = {{ (onepasswordDetailsFields "ug2d3ssijhy353ajrffwx2lwei").password.value | quote }}

[data.pulumi]
  token = {{ (onepassword "tmqlgotrl6aanzjga5i5oqagz4").details.password | quote }}
  octos.token = {{ (onepassword "vp4hh3gjwebnghzsfan4mvvjwu").details.password | quote }}
  salt.token = {{ (onepassword "5fc3qc4ujqmg5jwk7resr4ee3m").details.password | quote }}

[data.ngrok]
  token = {{ (onepassword "dr4s4kl3vwiiky7lbzg3sm46om").details.password | quote }}
